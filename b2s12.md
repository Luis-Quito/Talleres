# Taller Individual 3
## EDA (Exploratory Data Analysis)

**Semana:** 12  
**Asignatura:** Programación Funcional y Reactiva  

---

### Objetivos:
- Crear un `case class` en Scala para modelar datos específicos de un archivo CSV de la LigaPro.
- Manipular colecciones de datos y realizar operaciones de filtrado y cálculos estadísticos básicos.
- Aplicar una fórmula matemática de dispersión mediante el uso de funciones de agregación.

> [!IMPORTANT]
> Resolver el siguiente problema de forma **individual**. El archivo a utilizar es: [**`LigaPro2025-2026.csv`**](https://www.dropbox.com/scl/fi/f0e2dybzz48zp8i2aj01a/LigaPro2025-2026.csv?rlkey=sw9z7mwrzvpj3kpiht2xfoz09&st=xdgxbms2&dl=0). El estudiante debe desarrollar toda la solución (definición de estructura, lectura y análisis) en **un mismo archivo de Scala**. El trabajo se presenta directamente al docente en el aula.

---

### Parte 1: Definición de case class y lectura de archivo

1. **Definición de la estructura:** Cree una `case class` llamada `Jugador` que permita leer las siguientes columnas del archivo CSV: `Pos`, `Nombre`, `Equipo`, `PJ` y `Goles`.

2. **Implementación de lectura:** Utilizando la librería `fs2-data-csv` y el stack de `Cats Effect`, realice la lectura del archivo y convierta los datos en una lista de objetos de tipo `Jugador`. 
    - **Nota:** El delimitador del archivo es la coma (`,`).

---

### Parte 2: Análisis de datos (EDA)

Utilizando la lista de objetos obtenida en la parte anterior, implemente la lógica dentro del mismo programa para obtener los siguientes indicadores:

1. **Sumatoria:** Calcule el total de goles marcados por todos los jugadores en el listado.
2. **Promedio:** Obtenga el promedio de partidos jugados (`PJ`) de todos los jugadores.
3. **Valores Extremos:** Encuentre el valor **máximo** y el valor **mínimo** de la columna de partidos jugados (`PJ`).
4. **Estadístico Adicional (Desviación Media):** Calcule la Desviación Media de los goles. Este estadístico mide cuánto se alejan, en promedio, los goles de cada jugador respecto a la media aritmética. 

La fórmula es:

$$
DM = \frac{\sum_{i=1}^{n} |x_i - \overline{x}|}{n}
$$

Donde:
- $x_i$: es el número de **goles** de cada jugador.
- $\overline{x}$: es el promedio de **goles** del conjunto.
- $n$: es el número total de jugadores.
- $| \dots |$: representa el valor absoluto.

---

### Parte 3: Análisis Crítico (Comentario en el Código)

**Instrucción de cierre:** Una vez obtenido el valor de la **Desviación Media (DM)**, el estudiante no debe simplemente imprimirlo, sino que debe **redactar una conclusión breve como un comentario de bloque (`/* ... */`) al final de su archivo de código Scala**. 

En dicho comentario, debe inferir lo siguiente basándose en el resultado:
* ¿Qué interpretación le da a este valor respecto a la consistencia de los goleadores de la liga? (¿Están todos cerca del promedio o hay mucha disparidad?).

* El valor obtenido de la Desviación Media indica el nivel de consistencia en la producción goleadora de los jugadores de la liga. Si la Desviación Media es baja, significa que la mayoría de los goleadores registra una cantidad de goles cercana al promedio, lo que refleja un rendimiento relativamente homogéneo entre los jugadores. En cambio, si la Desviación Media es alta, evidencia una marcada disparidad, indicando que existen pocos jugadores con muchos goles y varios con cifras muy por debajo del promedio, lo que demuestra una baja consistencia colectiva en la liga.

> **Nota de desarrollo:** Trabajar en un único archivo fuente de Scala que contenga la `case class`, la lógica de procesamiento y el comentario final para ser revisado por el docente.

---

### ✅ Calificación:

Una vez que termine debe presentar su trabajo a su docente.

- **10 puntos:** si presenta en el horario de prácticas y experimentación.
- **7 puntos:** si presenta en el horario de tutoría.

**La hora máxima de presentación será las 08h30.**

**Case Class

```Scala
package taller

case class LigaPro(
                    Pos: Int,
                    Nombre: String,
                    Equipo: String,
                    PJ: Int,
                    Goles: Int
                  )
```

**Codigo

```Scala
package taller
import cats.effect.{IO, IOApp}
import fs2.text
import fs2.io.file.{Files, Path}
import fs2.data.csv.*
import fs2.data.csv.generic.semiauto.*

import taller.LigaPro

// Derivación semiautomática
given CsvRowDecoder[LigaPro, String] = deriveCsvRowDecoder[LigaPro]

object Estadisticas:

  def suma(datos: List[Int]): Int =
    datos.sum

  def promedio1(datos: List[Int]): Double =
    if datos.isEmpty then 0.0
    else datos.sum.toDouble / datos.length

  def maximo(datos: List[Int]): Int =
    if datos.isEmpty then 0
    else datos.max

  def minimo(datos: List[Int]): Int =
    if datos.isEmpty then 0
    else datos.min

  // Desviación Media (DM)
  def desviacionMedia(datos: List[Int]): Double =
    val prom = promedio1(datos)
    datos.map(x => math.abs(x - prom)).sum / datos.length


object EDA_Jugador extends IOApp.Simple:

  // Ruta al archivo CSV (ajusta si es necesario)
  val filePath = Path(
    "C:\\Users\\Core i5-Pro\\IdeaProjects\\ClaseO25F26\\src\\main\\resources\\data\\LigaPro2025-2026.csv"
  )

  val run: IO[Unit] =
    val lecturaCSV: IO[List[LigaPro]] =
      Files[IO]
        .readAll(filePath)
        .through(text.utf8.decode)
        .through(decodeUsingHeaders[LigaPro](','))
        .compile
        .toList

    lecturaCSV.flatMap { jugadores =>

      val colGoles: List[Int] = jugadores.map(_.Goles)
      val colPJ: List[Int] = jugadores.map(_.PJ)

      val totalGoles = Estadisticas.suma(colGoles)
      val promedioPJ = Estadisticas.promedio1(colPJ)
      val maxPJ = Estadisticas.maximo(colPJ)
      val minPJ = Estadisticas.minimo(colPJ)
      val desviacionMediaGoles = Estadisticas.desviacionMedia(colGoles)

      IO.println("=" * 45) >>
        IO.println(s" TOTAL DE JUGADORES: ${jugadores.length}") >>
        IO.println(s" TOTAL DE GOLES: $totalGoles") >>
        IO.println(f" PROMEDIO DE PJ: $promedioPJ%.2f") >>
        IO.println(s" PJ MAXIMO: $maxPJ") >>
        IO.println(s" PJ MINIMO: $minPJ") >>
        IO.println(f" DESVIACION MEDIA DE GOLES: $desviacionMediaGoles%.2f") >>
        IO.println("=" * 45)

    }.handleErrorWith { error =>
      IO.println(s"Error procesando CSV: ${error.getMessage}")
    }
```

